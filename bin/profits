#!/usr/bin/env coffee

fs   = require 'fs'
path = require 'path'

companies = JSON.parse(fs.readFileSync(path.resolve(__dirname, '..', 'gen', 'companies.json')))
companies = companies.filter ({profits}) -> profits?[2012] > 0
companies.sort (company1, company2) -> company2.profits[2012] - company1.profits[2012]

for {name, symbol, profits} in companies
  profit = profits[2012]
  if profit > 1000000000
    billions = Math.round(profit / 1000000000)
    console.log("#{symbol}: #{name} #{billions}B")
  else if profit > 1000000
    millions = Math.round(profit / 1000000)
    console.log("#{symbol}: #{name} #{millions}M")
  else
    thousands = Math.round(profit / 1000)
    console.log("#{symbol}: #{name} #{thousands}K")
